SELECT object_construct('x', "CENTER", 'y', "COUNT(BUCKET-IDX)") FROM ( SELECT  *  FROM ( SELECT "CENTER", count("bucket-idx") AS "COUNT(BUCKET-IDX)" FROM ( SELECT *, ((("bucket-idx" * 1.85 :: FLOAT) + 0.925 :: FLOAT) + 0.19999981 :: FLOAT) AS "CENTER" FROM ( SELECT *, floor(("truncated-value" / 1.85 :: FLOAT)) AS "bucket-idx" FROM ( SELECT *, iff(("S" < 15.0 :: FLOAT), (15.0 :: FLOAT - 0.925 :: FLOAT), iff(("S" > 200.0 :: FLOAT), (200.0 :: FLOAT + 0.925 :: FLOAT), ("S" - 0.19999981 :: FLOAT))) AS "truncated-value" FROM ( SELECT * FROM ( SELECT "S" FROM ( SELECT "SUM_INDEX", "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "filtered-jets", "SUBQUERY_RESULT" AS "S" FROM ( SELECT "SUM_INDEX", any_value("RUN") AS "RUN", any_value("LUMINOSITYBLOCK") AS "LUMINOSITYBLOCK", any_value("EVENT") AS "EVENT", any_value("HLT") AS "HLT", any_value("PV") AS "PV", any_value("MET") AS "MET", any_value("MUON") AS "MUON", any_value("ELECTRON") AS "ELECTRON", any_value("TAU") AS "TAU", any_value("PHOTON") AS "PHOTON", any_value("JET") AS "JET", any_value("filtered-jets") AS "filtered-jets", sum("VALUE") AS "SUBQUERY_RESULT" FROM ( SELECT  *  FROM ( SELECT *, seq8(0) AS "SUM_INDEX" FROM ( SELECT  *  FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "SUBQUERY_RESULT" AS "filtered-jets" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "SUBQUERY_RESULT" FROM ( SELECT "STATIC_INDEX_2", any_value("RUN") AS "RUN", any_value("LUMINOSITYBLOCK") AS "LUMINOSITYBLOCK", any_value("EVENT") AS "EVENT", any_value("HLT") AS "HLT", any_value("PV") AS "PV", any_value("MET") AS "MET", any_value("MUON") AS "MUON", any_value("ELECTRON") AS "ELECTRON", any_value("TAU") AS "TAU", any_value("PHOTON") AS "PHOTON", any_value("JET") AS "JET", any_value("STATIC_INDEX_2") AS "STATIC_INDEX_2", any_value("JETVAR_INDEX") AS "JETVAR_INDEX", any_value("JETVAR") AS "JETVAR", any_value("SHOULD_KEEP_2") AS "SHOULD_KEEP_2", any_value("RETURN_TEMP_COLUMN") AS "RETURN_TEMP_COLUMN", array_agg("RETURN_TEMP_COLUMN") AS "SUBQUERY_RESULT" FROM ( SELECT *, iff("SHOULD_KEEP_2", NULL, "JETVAR"['pt']) AS "RETURN_TEMP_COLUMN" FROM ( SELECT * FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "SHOULD_KEEP_2" FROM ( SELECT  *  FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "SUBQUERY_RESULT", "TEMP_PREDICATE", "TT" AS "SHOULD_KEEP_2" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "SUBQUERY_RESULT", "TEMP_PREDICATE", "TT" FROM ( SELECT *, ("SHOULD_KEEP_2" OR NOT "TEMP_PREDICATE") AS "TT" FROM ( SELECT *, ("SUBQUERY_RESULT" = 0:: INTEGER) AS "TEMP_PREDICATE" FROM ( SELECT * FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "SHOULD_KEEP_2", "SUBQUERY_RESULT" FROM ( SELECT "STATIC_INDEX_5", any_value("RUN") AS "RUN", any_value("LUMINOSITYBLOCK") AS "LUMINOSITYBLOCK", any_value("EVENT") AS "EVENT", any_value("HLT") AS "HLT", any_value("PV") AS "PV", any_value("MET") AS "MET", any_value("MUON") AS "MUON", any_value("ELECTRON") AS "ELECTRON", any_value("TAU") AS "TAU", any_value("PHOTON") AS "PHOTON", any_value("JET") AS "JET", any_value("STATIC_INDEX_2") AS "STATIC_INDEX_2", any_value("JETVAR_INDEX") AS "JETVAR_INDEX", any_value("JETVAR") AS "JETVAR", any_value("SHOULD_KEEP_2") AS "SHOULD_KEEP_2", any_value("STATIC_INDEX_5") AS "STATIC_INDEX_5", any_value("ELECTRONVAR_INDEX") AS "ELECTRONVAR_INDEX", any_value("ELECTRONVAR") AS "ELECTRONVAR", any_value("SHOULD_KEEP_5") AS "SHOULD_KEEP_5", any_value("RETURN_TEMP_COLUMN") AS "RETURN_TEMP_COLUMN", count("RETURN_TEMP_COLUMN") AS "SUBQUERY_RESULT" FROM ( SELECT *, iff("SHOULD_KEEP_5", NULL, 1:: INTEGER) AS "RETURN_TEMP_COLUMN" FROM ( SELECT * FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "SHOULD_KEEP_2", "STATIC_INDEX_5", "ELECTRONVAR_INDEX", "ELECTRONVAR", "SHOULD_KEEP_5" FROM ( SELECT  *  FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "SUBQUERY_RESULT", "SHOULD_KEEP_2", "STATIC_INDEX_5", "ELECTRONVAR_INDEX", "ELECTRONVAR", "TEMP_PREDICATE", "TT" AS "SHOULD_KEEP_5" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "SUBQUERY_RESULT", "SHOULD_KEEP_2", "STATIC_INDEX_5", "ELECTRONVAR_INDEX", "ELECTRONVAR", "TEMP_PREDICATE", "TT" FROM ( SELECT *, ("SHOULD_KEEP_5" OR NOT "TEMP_PREDICATE") AS "TT" FROM ( SELECT *, (("ELECTRONVAR"['pt'] > 10:: INTEGER) AND (sqrt((((((("JETVAR"['phi'] - "ELECTRONVAR"['phi']) + 3.141592654 :: FLOAT) % (2:: INTEGER * 3.141592654 :: FLOAT)) - 3.141592654 :: FLOAT) * (((("JETVAR"['phi'] - "ELECTRONVAR"['phi']) + 3.141592654 :: FLOAT) % (2:: INTEGER * 3.141592654 :: FLOAT)) - 3.141592654 :: FLOAT)) + (("JETVAR"['eta'] - "ELECTRONVAR"['eta']) * ("JETVAR"['eta'] - "ELECTRONVAR"['eta'])))) < 0.4 :: FLOAT)) AS "TEMP_PREDICATE" FROM ( SELECT * FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "SUBQUERY_RESULT", "SHOULD_KEEP_2", "STATIC_INDEX_5", "SHOULD_KEEP_5", "INDEX" AS "ELECTRONVAR_INDEX", "ELECTRONVAR" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "SUBQUERY_RESULT", "SHOULD_KEEP_2", "STATIC_INDEX_5", "SHOULD_KEEP_5", "INDEX", "VALUE" AS "ELECTRONVAR" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "SUBQUERY_RESULT", "SHOULD_KEEP_2", "STATIC_INDEX_5", "SHOULD_KEEP_5", "INDEX", "VALUE" FROM ( SELECT  *  FROM ( SELECT *, (Electron IS NULL OR (array_size(Electron) = 0 :: INTEGER)) AS "SHOULD_KEEP_5" FROM ( SELECT *, seq8(0) AS "STATIC_INDEX_5" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "SUBQUERY_RESULT", "SHOULD_KEEP_2" FROM ( SELECT  *  FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "SUBQUERY_RESULT", "TEMP_PREDICATE", "TT" AS "SHOULD_KEEP_2" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "SUBQUERY_RESULT", "TEMP_PREDICATE", "TT" FROM ( SELECT *, ("SHOULD_KEEP_2" OR NOT "TEMP_PREDICATE") AS "TT" FROM ( SELECT *, ("SUBQUERY_RESULT" = 0:: INTEGER) AS "TEMP_PREDICATE" FROM ( SELECT * FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "SHOULD_KEEP_2", "SUBQUERY_RESULT" FROM ( SELECT "STATIC_INDEX_5", any_value("RUN") AS "RUN", any_value("LUMINOSITYBLOCK") AS "LUMINOSITYBLOCK", any_value("EVENT") AS "EVENT", any_value("HLT") AS "HLT", any_value("PV") AS "PV", any_value("MET") AS "MET", any_value("MUON") AS "MUON", any_value("ELECTRON") AS "ELECTRON", any_value("TAU") AS "TAU", any_value("PHOTON") AS "PHOTON", any_value("JET") AS "JET", any_value("STATIC_INDEX_2") AS "STATIC_INDEX_2", any_value("JETVAR_INDEX") AS "JETVAR_INDEX", any_value("JETVAR") AS "JETVAR", any_value("SHOULD_KEEP_2") AS "SHOULD_KEEP_2", any_value("STATIC_INDEX_5") AS "STATIC_INDEX_5", any_value("MUONVAR_INDEX") AS "MUONVAR_INDEX", any_value("MUONVAR") AS "MUONVAR", any_value("SHOULD_KEEP_5") AS "SHOULD_KEEP_5", any_value("RETURN_TEMP_COLUMN") AS "RETURN_TEMP_COLUMN", count("RETURN_TEMP_COLUMN") AS "SUBQUERY_RESULT" FROM ( SELECT *, iff("SHOULD_KEEP_5", NULL, 1:: INTEGER) AS "RETURN_TEMP_COLUMN" FROM ( SELECT * FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "SHOULD_KEEP_2", "STATIC_INDEX_5", "MUONVAR_INDEX", "MUONVAR", "SHOULD_KEEP_5" FROM ( SELECT  *  FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "SHOULD_KEEP_2", "STATIC_INDEX_5", "MUONVAR_INDEX", "MUONVAR", "TEMP_PREDICATE", "TT" AS "SHOULD_KEEP_5" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "SHOULD_KEEP_2", "STATIC_INDEX_5", "MUONVAR_INDEX", "MUONVAR", "TEMP_PREDICATE", "TT" FROM ( SELECT *, ("SHOULD_KEEP_5" OR NOT "TEMP_PREDICATE") AS "TT" FROM ( SELECT *, (("MUONVAR"['pt'] > 10:: INTEGER) AND (sqrt((((((("JETVAR"['phi'] - "MUONVAR"['phi']) + 3.141592654 :: FLOAT) % (2:: INTEGER * 3.141592654 :: FLOAT)) - 3.141592654 :: FLOAT) * (((("JETVAR"['phi'] - "MUONVAR"['phi']) + 3.141592654 :: FLOAT) % (2:: INTEGER * 3.141592654 :: FLOAT)) - 3.141592654 :: FLOAT)) + (("JETVAR"['eta'] - "MUONVAR"['eta']) * ("JETVAR"['eta'] - "MUONVAR"['eta'])))) < 0.4 :: FLOAT)) AS "TEMP_PREDICATE" FROM ( SELECT * FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "SHOULD_KEEP_2", "STATIC_INDEX_5", "SHOULD_KEEP_5", "INDEX" AS "MUONVAR_INDEX", "MUONVAR" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "SHOULD_KEEP_2", "STATIC_INDEX_5", "SHOULD_KEEP_5", "INDEX", "VALUE" AS "MUONVAR" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "SHOULD_KEEP_2", "STATIC_INDEX_5", "SHOULD_KEEP_5", "INDEX", "VALUE" FROM ( SELECT  *  FROM ( SELECT *, (Muon IS NULL OR (array_size(Muon) = 0 :: INTEGER)) AS "SHOULD_KEEP_5" FROM ( SELECT *, seq8(0) AS "STATIC_INDEX_5" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "SHOULD_KEEP_2" FROM ( SELECT  *  FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "TEMP_PREDICATE", "TT" AS "SHOULD_KEEP_2" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "JETVAR_INDEX", "JETVAR", "TEMP_PREDICATE", "TT" FROM ( SELECT *, ("SHOULD_KEEP_2" OR NOT "TEMP_PREDICATE") AS "TT" FROM ( SELECT *, ("JETVAR"['pt'] > 30:: INTEGER) AS "TEMP_PREDICATE" FROM ( SELECT * FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "SHOULD_KEEP_2", "INDEX" AS "JETVAR_INDEX", "JETVAR" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "SHOULD_KEEP_2", "INDEX", "VALUE" AS "JETVAR" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_2", "SHOULD_KEEP_2", "INDEX", "VALUE" FROM ( SELECT  *  FROM ( SELECT *, (Jet IS NULL OR (array_size(Jet) = 0 :: INTEGER)) AS "SHOULD_KEEP_2" FROM ( SELECT *, seq8(0) AS "STATIC_INDEX_2" FROM ( SELECT  *  FROM (adl)))),  LATERAL  FLATTEN ( INPUT  => Jet,  PATH  => '',  OUTER  => true,  RECURSIVE  => false,  MODE  => 'ARRAY')))))))))) WHERE ("TEMP_PREDICATE" IS NULL OR ("TEMP_PREDICATE" OR (NOT "TEMP_PREDICATE" AND ("JETVAR_INDEX" IS NULL OR ("JETVAR_INDEX" = 0 :: INTEGER))))))))),  LATERAL  FLATTEN ( INPUT  => Muon,  PATH  => '',  OUTER  => true,  RECURSIVE  => false,  MODE  => 'ARRAY')))))))))) WHERE ("TEMP_PREDICATE" IS NULL OR ("TEMP_PREDICATE" OR (NOT "TEMP_PREDICATE" AND ("MUONVAR_INDEX" IS NULL OR ("MUONVAR_INDEX" = 0 :: INTEGER))))))))) GROUP BY "STATIC_INDEX_5"))))))) WHERE ("TEMP_PREDICATE" IS NULL OR ("TEMP_PREDICATE" OR (NOT "TEMP_PREDICATE" AND ("JETVAR_INDEX" IS NULL OR ("JETVAR_INDEX" = 0 :: INTEGER))))))))),  LATERAL  FLATTEN ( INPUT  => Electron,  PATH  => '',  OUTER  => true,  RECURSIVE  => false,  MODE  => 'ARRAY')))))))))) WHERE ("TEMP_PREDICATE" IS NULL OR ("TEMP_PREDICATE" OR (NOT "TEMP_PREDICATE" AND ("ELECTRONVAR_INDEX" IS NULL OR ("ELECTRONVAR_INDEX" = 0 :: INTEGER))))))))) GROUP BY "STATIC_INDEX_5"))))))) WHERE ("TEMP_PREDICATE" IS NULL OR ("TEMP_PREDICATE" OR (NOT "TEMP_PREDICATE" AND ("JETVAR_INDEX" IS NULL OR ("JETVAR_INDEX" = 0 :: INTEGER))))))))) GROUP BY "STATIC_INDEX_2"))) WHERE (array_size("filtered-jets") > 0:: INTEGER))),  LATERAL  FLATTEN ( INPUT  => "filtered-jets",  PATH  => '',  OUTER  => false,  RECURSIVE  => false,  MODE  => 'ARRAY')) GROUP BY "SUM_INDEX"))))))) GROUP BY "CENTER") ORDER BY "CENTER" ASC NULLS FIRST);