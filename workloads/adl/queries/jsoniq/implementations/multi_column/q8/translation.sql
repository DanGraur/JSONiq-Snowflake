SELECT object_construct('x', "CENTER", 'y', "COUNT(BUCKET-IDX)") FROM ( SELECT  *  FROM ( SELECT "CENTER", count("bucket-idx") AS "COUNT(BUCKET-IDX)" FROM ( SELECT *, ((("bucket-idx" * 2.35 :: FLOAT) + 1.175 :: FLOAT) + 0.9000006 :: FLOAT) AS "CENTER" FROM ( SELECT *, floor(("truncated-value" / 2.35 :: FLOAT)) AS "bucket-idx" FROM ( SELECT *, iff(("SQRT((((2:: INTEGER * MET['PT']) * ""OTHER-LEPTION""['PT']) * (1.0 :: FLOAT - COS(((((MET['PHI'] - ""OTHER-LEPTION""['PHI']) + 3.141592654 :: FLOAT) % (2:: INTEGER * 3.141592654 :: FLOAT)) - 3.141592654 :: FLOAT)))))" < 15.0 :: FLOAT), (15.0 :: FLOAT - 1.175 :: FLOAT), iff(("SQRT((((2:: INTEGER * MET['PT']) * ""OTHER-LEPTION""['PT']) * (1.0 :: FLOAT - COS(((((MET['PHI'] - ""OTHER-LEPTION""['PHI']) + 3.141592654 :: FLOAT) % (2:: INTEGER * 3.141592654 :: FLOAT)) - 3.141592654 :: FLOAT)))))" > 250.0 :: FLOAT), (250.0 :: FLOAT + 1.175 :: FLOAT), ("SQRT((((2:: INTEGER * MET['PT']) * ""OTHER-LEPTION""['PT']) * (1.0 :: FLOAT - COS(((((MET['PHI'] - ""OTHER-LEPTION""['PHI']) + 3.141592654 :: FLOAT) % (2:: INTEGER * 3.141592654 :: FLOAT)) - 3.141592654 :: FLOAT)))))" - 0.9000006 :: FLOAT))) AS "truncated-value" FROM ( SELECT * FROM ( SELECT sqrt((((2:: INTEGER * MET['pt']) * "other-leption"['pt']) * (1.0 :: FLOAT - cos(((((MET['phi'] - "other-leption"['phi']) + 3.141592654 :: FLOAT) % (2:: INTEGER * 3.141592654 :: FLOAT)) - 3.141592654 :: FLOAT))))) FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "closest-lepton-pair", "other-leption" FROM ( SELECT *, get("SUBQUERY_RESULT", 0:: INTEGER) AS "other-leption" FROM ( SELECT * FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "closest-lepton-pair", "SUBQUERY_RESULT" FROM ( SELECT "STATIC_INDEX_3", any_value("RUN") AS "RUN", any_value("LUMINOSITYBLOCK") AS "LUMINOSITYBLOCK", any_value("EVENT") AS "EVENT", any_value("HLT") AS "HLT", any_value("PV") AS "PV", any_value("MET") AS "MET", any_value("MUON") AS "MUON", any_value("ELECTRON") AS "ELECTRON", any_value("TAU") AS "TAU", any_value("PHOTON") AS "PHOTON", any_value("JET") AS "JET", any_value("LEPTONS") AS "LEPTONS", any_value("closest-lepton-pair") AS "closest-lepton-pair", any_value("STATIC_INDEX_3") AS "STATIC_INDEX_3", any_value("K") AS "K", any_value("LEPTON") AS "LEPTON", any_value("SHOULD_KEEP_3") AS "SHOULD_KEEP_3", any_value("RETURN_TEMP_COLUMN") AS "RETURN_TEMP_COLUMN", array_agg("RETURN_TEMP_COLUMN") WITHIN GROUP ( ORDER BY "LEPTON"['pt'] DESC NULLS LAST) AS "SUBQUERY_RESULT" FROM ( SELECT *, iff("SHOULD_KEEP_3", NULL, "LEPTON") AS "RETURN_TEMP_COLUMN" FROM ( SELECT * FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "closest-lepton-pair", "STATIC_INDEX_3", "K", "LEPTON", "SHOULD_KEEP_3" FROM ( SELECT  *  FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "closest-lepton-pair", "STATIC_INDEX_3", "K", "LEPTON", "TEMP_PREDICATE", "TT" AS "SHOULD_KEEP_3" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "closest-lepton-pair", "STATIC_INDEX_3", "K", "LEPTON", "TEMP_PREDICATE", "TT" FROM ( SELECT *, ("SHOULD_KEEP_3" OR NOT "TEMP_PREDICATE") AS "TT" FROM ( SELECT *, (("K" <> "closest-lepton-pair"['i']) AND ("K" <> "closest-lepton-pair"['j'])) AS "TEMP_PREDICATE" FROM ( SELECT * FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "closest-lepton-pair", "STATIC_INDEX_3", "SHOULD_KEEP_3", "INDEX" AS "K", "LEPTON" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "closest-lepton-pair", "STATIC_INDEX_3", "SHOULD_KEEP_3", "INDEX", "VALUE" AS "LEPTON" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "closest-lepton-pair", "STATIC_INDEX_3", "SHOULD_KEEP_3", "INDEX", "VALUE" FROM ( SELECT  *  FROM ( SELECT *, ("LEPTONS" IS NULL OR (array_size("LEPTONS") = 0 :: INTEGER)) AS "SHOULD_KEEP_3" FROM ( SELECT *, seq8(0) AS "STATIC_INDEX_3" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "closest-lepton-pair" FROM ( SELECT *, get("SUBQUERY_RESULT", 0:: INTEGER) AS "closest-lepton-pair" FROM ( SELECT * FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "SUBQUERY_RESULT" FROM ( SELECT "STATIC_INDEX_3", any_value("RUN") AS "RUN", any_value("LUMINOSITYBLOCK") AS "LUMINOSITYBLOCK", any_value("EVENT") AS "EVENT", any_value("HLT") AS "HLT", any_value("PV") AS "PV", any_value("MET") AS "MET", any_value("MUON") AS "MUON", any_value("ELECTRON") AS "ELECTRON", any_value("TAU") AS "TAU", any_value("PHOTON") AS "PHOTON", any_value("JET") AS "JET", any_value("LEPTONS") AS "LEPTONS", any_value("STATIC_INDEX_3") AS "STATIC_INDEX_3", any_value("I") AS "I", any_value("LEPTON1") AS "LEPTON1", any_value("J") AS "J", any_value("LEPTON2") AS "LEPTON2", any_value("SHOULD_KEEP_3") AS "SHOULD_KEEP_3", any_value("PTETAPHIM_TO_PXPYPZE1") AS "PTETAPHIM_TO_PXPYPZE1", any_value("PTETAPHIM_TO_PXPYPZE2") AS "PTETAPHIM_TO_PXPYPZE2", any_value("PARTICLE") AS "PARTICLE", any_value("PXPYPZE_TO_PTETAPHIM") AS "PXPYPZE_TO_PTETAPHIM", any_value("order-criterion") AS "order-criterion", any_value("RETURN_TEMP_COLUMN") AS "RETURN_TEMP_COLUMN", array_agg("RETURN_TEMP_COLUMN") WITHIN GROUP ( ORDER BY "order-criterion" ASC NULLS FIRST) AS "SUBQUERY_RESULT" FROM ( SELECT *, iff("SHOULD_KEEP_3", NULL, object_construct('i', "I", 'j', "J")) AS "RETURN_TEMP_COLUMN" FROM ( SELECT *, abs((91.2 :: FLOAT - "PXPYPZE_TO_PTETAPHIM"['mass'])) AS "order-criterion" FROM ( SELECT * FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "STATIC_INDEX_3", "I", "LEPTON1", "J", "LEPTON2", "SHOULD_KEEP_3", "PTETAPHIM_TO_PXPYPZE1", "PTETAPHIM_TO_PXPYPZE2", "PARTICLE", "SUBQUERY_RESULT" AS "PXPYPZE_TO_PTETAPHIM" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "STATIC_INDEX_3", "I", "LEPTON1", "J", "LEPTON2", "SHOULD_KEEP_3", "PTETAPHIM_TO_PXPYPZE1", "PTETAPHIM_TO_PXPYPZE2", "PARTICLE", "SUBQUERY_RESULT" FROM ( SELECT *, object_construct('pt', "PT4", 'eta', "ETA4", 'phi', "PHI4", 'mass', "MASS4") AS "SUBQUERY_RESULT" FROM ( SELECT *, sqrt(((("E4" - "Z4") - "Y4") - "X4")) AS "MASS4" FROM ( SELECT *, iff((("PARTICLE"['x'] = 0.0 :: FLOAT) AND ("PARTICLE"['y'] = 0.0 :: FLOAT)), 0.0 :: FLOAT, atan2("PARTICLE"['y'], "PARTICLE"['x'])) AS "PHI4" FROM ( SELECT * FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "STATIC_INDEX_3", "I", "LEPTON1", "J", "LEPTON2", "SHOULD_KEEP_3", "PTETAPHIM_TO_PXPYPZE1", "PTETAPHIM_TO_PXPYPZE2", "PARTICLE", "X4", "Y4", "Z4", "E4", "PT4", "SUBQUERY_RESULT" AS "ETA4" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "STATIC_INDEX_3", "I", "LEPTON1", "J", "LEPTON2", "SHOULD_KEEP_3", "PTETAPHIM_TO_PXPYPZE1", "PTETAPHIM_TO_PXPYPZE2", "PARTICLE", "X4", "Y4", "Z4", "E4", "PT4", "SUBQUERY_RESULT" FROM ( SELECT *, log(2.718281828459045:: FLOAT, ("TEMP4" + sqrt((("TEMP4" * "TEMP4") + 1.0 :: FLOAT)))) AS "SUBQUERY_RESULT" FROM ( SELECT *, ("PARTICLE"['z'] / "PT4") AS "TEMP4" FROM ( SELECT *, sqrt(("X4" + "Y4")) AS "PT4" FROM ( SELECT *, ("PARTICLE"['e'] * "PARTICLE"['e']) AS "E4" FROM ( SELECT *, ("PARTICLE"['z'] * "PARTICLE"['z']) AS "Z4" FROM ( SELECT *, ("PARTICLE"['y'] * "PARTICLE"['y']) AS "Y4" FROM ( SELECT *, ("PARTICLE"['x'] * "PARTICLE"['x']) AS "X4" FROM ( SELECT * FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "STATIC_INDEX_3", "I", "LEPTON1", "J", "LEPTON2", "SHOULD_KEEP_3", "PTETAPHIM_TO_PXPYPZE1", "PTETAPHIM_TO_PXPYPZE2", "SUBQUERY_RESULT" AS "PARTICLE" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "STATIC_INDEX_3", "I", "LEPTON1", "J", "LEPTON2", "SHOULD_KEEP_3", "PTETAPHIM_TO_PXPYPZE1", "PTETAPHIM_TO_PXPYPZE2", "SUBQUERY_RESULT" FROM ( SELECT *, object_construct('x', "X3", 'y', "Y3", 'z', "Z3", 'e', "E3") AS "SUBQUERY_RESULT" FROM ( SELECT *, ("PTETAPHIM_TO_PXPYPZE1"['e'] + "PTETAPHIM_TO_PXPYPZE2"['e']) AS "E3" FROM ( SELECT *, ("PTETAPHIM_TO_PXPYPZE1"['z'] + "PTETAPHIM_TO_PXPYPZE2"['z']) AS "Z3" FROM ( SELECT *, ("PTETAPHIM_TO_PXPYPZE1"['y'] + "PTETAPHIM_TO_PXPYPZE2"['y']) AS "Y3" FROM ( SELECT *, ("PTETAPHIM_TO_PXPYPZE1"['x'] + "PTETAPHIM_TO_PXPYPZE2"['x']) AS "X3" FROM ( SELECT * FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "STATIC_INDEX_3", "I", "LEPTON1", "J", "LEPTON2", "SHOULD_KEEP_3", "PTETAPHIM_TO_PXPYPZE1", "SUBQUERY_RESULT" AS "PTETAPHIM_TO_PXPYPZE2" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "STATIC_INDEX_3", "I", "LEPTON1", "J", "LEPTON2", "SHOULD_KEEP_3", "PTETAPHIM_TO_PXPYPZE1", "SUBQUERY_RESULT" FROM ( SELECT *, object_construct('x', "X2", 'y', "Y2", 'z', "Z2", 'e', "E2") AS "SUBQUERY_RESULT" FROM ( SELECT *, sqrt((("TEMP2" * "TEMP2") + ("LEPTON2"['mass'] * "LEPTON2"['mass']))) AS "E2" FROM ( SELECT *, (("LEPTON2"['pt'] * (exp("LEPTON2"['eta']) + exp(- "LEPTON2"['eta']))) / 2.0 :: FLOAT) AS "TEMP2" FROM ( SELECT *, (("LEPTON2"['pt'] * (exp("LEPTON2"['eta']) - exp(- "LEPTON2"['eta']))) / 2.0 :: FLOAT) AS "Z2" FROM ( SELECT *, ("LEPTON2"['pt'] * sin("LEPTON2"['phi'])) AS "Y2" FROM ( SELECT *, ("LEPTON2"['pt'] * cos("LEPTON2"['phi'])) AS "X2" FROM ( SELECT * FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "STATIC_INDEX_3", "I", "LEPTON1", "J", "LEPTON2", "SHOULD_KEEP_3", "SUBQUERY_RESULT" AS "PTETAPHIM_TO_PXPYPZE1" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "STATIC_INDEX_3", "I", "LEPTON1", "J", "LEPTON2", "SHOULD_KEEP_3", "SUBQUERY_RESULT" FROM ( SELECT *, object_construct('x', "X1", 'y', "Y1", 'z', "Z1", 'e', "E1") AS "SUBQUERY_RESULT" FROM ( SELECT *, sqrt((("TEMP1" * "TEMP1") + ("LEPTON1"['mass'] * "LEPTON1"['mass']))) AS "E1" FROM ( SELECT *, (("LEPTON1"['pt'] * (exp("LEPTON1"['eta']) + exp(- "LEPTON1"['eta']))) / 2.0 :: FLOAT) AS "TEMP1" FROM ( SELECT *, (("LEPTON1"['pt'] * (exp("LEPTON1"['eta']) - exp(- "LEPTON1"['eta']))) / 2.0 :: FLOAT) AS "Z1" FROM ( SELECT *, ("LEPTON1"['pt'] * sin("LEPTON1"['phi'])) AS "Y1" FROM ( SELECT *, ("LEPTON1"['pt'] * cos("LEPTON1"['phi'])) AS "X1" FROM ( SELECT * FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "STATIC_INDEX_3", "I", "LEPTON1", "J", "LEPTON2", "SHOULD_KEEP_3" FROM ( SELECT  *  FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "STATIC_INDEX_3", "I", "LEPTON1", "J", "LEPTON2", "TEMP_PREDICATE", "TT" AS "SHOULD_KEEP_3" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "STATIC_INDEX_3", "I", "LEPTON1", "J", "LEPTON2", "TEMP_PREDICATE", "TT" FROM ( SELECT *, ("SHOULD_KEEP_3" OR NOT "TEMP_PREDICATE") AS "TT" FROM ( SELECT *, ((("I" < "J") AND ("LEPTON1"['type'] = "LEPTON2"['type'])) AND ("LEPTON1"['charge'] <> "LEPTON2"['charge'])) AS "TEMP_PREDICATE" FROM ( SELECT * FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "STATIC_INDEX_3", "SHOULD_KEEP_3", "I", "LEPTON1", "INDEX" AS "J", "LEPTON2" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "STATIC_INDEX_3", "SHOULD_KEEP_3", "I", "LEPTON1", "INDEX", "VALUE" AS "LEPTON2" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "STATIC_INDEX_3", "SHOULD_KEEP_3", "I", "LEPTON1", "INDEX", "VALUE" FROM ( SELECT  *  FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "STATIC_INDEX_3", "SHOULD_KEEP_3", "INDEX" AS "I", "LEPTON1" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "STATIC_INDEX_3", "SHOULD_KEEP_3", "INDEX", "VALUE" AS "LEPTON1" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "LEPTONS", "STATIC_INDEX_3", "SHOULD_KEEP_3", "INDEX", "VALUE" FROM ( SELECT  *  FROM ( SELECT *, ("LEPTONS" IS NULL OR (array_size("LEPTONS") = 0 :: INTEGER)) AS "SHOULD_KEEP_3" FROM ( SELECT *, seq8(0) AS "STATIC_INDEX_3" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "SUBQUERY_RESULT" AS "LEPTONS" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "SUBQUERY_RESULT" FROM ( SELECT *, array_cat("MUONS", "ELECTRONS") AS "SUBQUERY_RESULT" FROM ( SELECT * FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "MUONS", "SUBQUERY_RESULT" AS "ELECTRONS" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "MUONS", "SUBQUERY_RESULT" FROM ( SELECT "STATIC_INDEX_3", any_value("RUN") AS "RUN", any_value("LUMINOSITYBLOCK") AS "LUMINOSITYBLOCK", any_value("EVENT") AS "EVENT", any_value("HLT") AS "HLT", any_value("PV") AS "PV", any_value("MET") AS "MET", any_value("MUON") AS "MUON", any_value("ELECTRON") AS "ELECTRON", any_value("TAU") AS "TAU", any_value("PHOTON") AS "PHOTON", any_value("JET") AS "JET", any_value("MUONS") AS "MUONS", any_value("STATIC_INDEX_3") AS "STATIC_INDEX_3", any_value("SHOULD_KEEP_3") AS "SHOULD_KEEP_3", any_value("ELECTRONVAR_INDEX") AS "ELECTRONVAR_INDEX", any_value("ELECTRONVAR") AS "ELECTRONVAR", any_value("RETURN_TEMP_COLUMN") AS "RETURN_TEMP_COLUMN", array_agg("RETURN_TEMP_COLUMN") AS "SUBQUERY_RESULT" FROM ( SELECT *, iff("SHOULD_KEEP_3", NULL, object_construct('pt', "ELECTRONVAR"['pt'], 'eta', "ELECTRONVAR"['eta'], 'phi', "ELECTRONVAR"['phi'], 'mass', "ELECTRONVAR"['mass'], 'charge', "ELECTRONVAR"['charge'], 'type', 'e')) AS "RETURN_TEMP_COLUMN" FROM ( SELECT * FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "MUONS", "STATIC_INDEX_3", "SHOULD_KEEP_3", "INDEX" AS "ELECTRONVAR_INDEX", "ELECTRONVAR" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "MUONS", "STATIC_INDEX_3", "SHOULD_KEEP_3", "INDEX", "VALUE" AS "ELECTRONVAR" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "MUONS", "STATIC_INDEX_3", "SHOULD_KEEP_3", "INDEX", "VALUE" FROM ( SELECT  *  FROM ( SELECT *, (Electron IS NULL OR (array_size(Electron) = 0 :: INTEGER)) AS "SHOULD_KEEP_3" FROM ( SELECT *, seq8(0) AS "STATIC_INDEX_3" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "SUBQUERY_RESULT" AS "MUONS" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "SUBQUERY_RESULT" FROM ( SELECT "STATIC_INDEX_3", any_value("RUN") AS "RUN", any_value("LUMINOSITYBLOCK") AS "LUMINOSITYBLOCK", any_value("EVENT") AS "EVENT", any_value("HLT") AS "HLT", any_value("PV") AS "PV", any_value("MET") AS "MET", any_value("MUON") AS "MUON", any_value("ELECTRON") AS "ELECTRON", any_value("TAU") AS "TAU", any_value("PHOTON") AS "PHOTON", any_value("JET") AS "JET", any_value("STATIC_INDEX_3") AS "STATIC_INDEX_3", any_value("SHOULD_KEEP_3") AS "SHOULD_KEEP_3", any_value("MUONVAR_INDEX") AS "MUONVAR_INDEX", any_value("MUONVAR") AS "MUONVAR", any_value("RETURN_TEMP_COLUMN") AS "RETURN_TEMP_COLUMN", array_agg("RETURN_TEMP_COLUMN") AS "SUBQUERY_RESULT" FROM ( SELECT *, iff("SHOULD_KEEP_3", NULL, object_construct('pt', "MUONVAR"['pt'], 'eta', "MUONVAR"['eta'], 'phi', "MUONVAR"['phi'], 'mass', "MUONVAR"['mass'], 'charge', "MUONVAR"['charge'], 'type', 'm')) AS "RETURN_TEMP_COLUMN" FROM ( SELECT * FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_3", "SHOULD_KEEP_3", "INDEX" AS "MUONVAR_INDEX", "MUONVAR" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_3", "SHOULD_KEEP_3", "INDEX", "VALUE" AS "MUONVAR" FROM ( SELECT "RUN", "LUMINOSITYBLOCK", "EVENT", "HLT", "PV", "MET", "MUON", "ELECTRON", "TAU", "PHOTON", "JET", "STATIC_INDEX_3", "SHOULD_KEEP_3", "INDEX", "VALUE" FROM ( SELECT  *  FROM ( SELECT *, (Muon IS NULL OR (array_size(Muon) = 0 :: INTEGER)) AS "SHOULD_KEEP_3" FROM ( SELECT *, seq8(0) AS "STATIC_INDEX_3" FROM ( SELECT  *  FROM ( SELECT  *  FROM (adl)) WHERE ((array_size(Muon) + array_size(Electron)) > 2:: INTEGER)))),  LATERAL  FLATTEN ( INPUT  => Muon,  PATH  => '',  OUTER  => true,  RECURSIVE  => false,  MODE  => 'ARRAY'))))))) GROUP BY "STATIC_INDEX_3"))))),  LATERAL  FLATTEN ( INPUT  => Electron,  PATH  => '',  OUTER  => true,  RECURSIVE  => false,  MODE  => 'ARRAY'))))))) GROUP BY "STATIC_INDEX_3"))))))))),  LATERAL  FLATTEN ( INPUT  => "LEPTONS",  PATH  => '',  OUTER  => true,  RECURSIVE  => false,  MODE  => 'ARRAY'))))),  LATERAL  FLATTEN ( INPUT  => "LEPTONS",  PATH  => '',  OUTER  => true,  RECURSIVE  => false,  MODE  => 'ARRAY')))))))))) WHERE ("TEMP_PREDICATE" IS NULL OR ("TEMP_PREDICATE" OR (NOT "TEMP_PREDICATE" AND (("J" IS NULL OR ("J" = 0 :: INTEGER)) OR ("I" IS NULL OR ("I" = 0 :: INTEGER))))))))))))))))))))))))))))))))))))))))))))))))))))) GROUP BY "STATIC_INDEX_3")))) WHERE "closest-lepton-pair" IS NOT NULL))),  LATERAL  FLATTEN ( INPUT  => "LEPTONS",  PATH  => '',  OUTER  => true,  RECURSIVE  => false,  MODE  => 'ARRAY')))))))))) WHERE ("TEMP_PREDICATE" IS NULL OR ("TEMP_PREDICATE" OR (NOT "TEMP_PREDICATE" AND ("K" IS NULL OR ("K" = 0 :: INTEGER))))))))) GROUP BY "STATIC_INDEX_3")))))))))) GROUP BY "CENTER") ORDER BY "CENTER" ASC NULLS FIRST);